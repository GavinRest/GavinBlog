import{_ as e,p as a,q as s,a1 as i}from"./framework-5866ffd3.js";const d="/assets/wireshark_tls_secret-24679867.png",l="/assets/wireshark_tls_test-1245a6aa.png",r={},t=i(`<h1 id="wireshark-解密-tls" tabindex="-1"><a class="header-anchor" href="#wireshark-解密-tls" aria-hidden="true">#</a> wireshark 解密 TLS</h1><blockquote><p>原理：获取 TLS 握手阶段生成的秘钥，通过 chrome DEBUG 日志中的握手信息生成秘钥</p></blockquote><h3 id="配置步骤" tabindex="-1"><a class="header-anchor" href="#配置步骤" aria-hidden="true">#</a> 配置步骤</h3><hr><ul><li><p>配置 chrome 输出 DEBUG 日志</p><ul><li><p>macos 添加临时环境变量</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>mkdir ~/sslkeylogfile &amp;&amp; touch ~/sslkeylogfile/key.log
export SSLKEYLOGFILE=~/sslkeylogfile/key.log
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>macos 添加永久环境变量</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>#zsh
echo &quot;\\nexport SSLKEYLOGFILE=~/sslkeylogfile/key.log&quot; &gt;&gt; ~/.zshrc &amp;&amp; source ~/.zshrc
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>检查</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># 使用终端打开 chrome 并打开 https://www.baidu.com/
open &quot;/Applications/Google Chrome.app&quot;
# 查看 key.log 文件
(venv3) ☁  sslkeylogfile [master] ⚡  cat ~/sslkeylogfile/key.log
CLIENT_HANDSHAKE_TRAFFIC_SECRET 9bd9c146254f587546805a6cb223c00a58d5e78574f9edbff98ebe9dad838d39 49e4a05e834f209603bf211a76c2b453f5c5e1d9910b5a5ad818f9b4baa2edb7
SERVER_HANDSHAKE_TRAFFIC_SECRET 9bd9c146254f587546805a6cb223c00a58d5e78574f9edbff98ebe9dad838d39 f4c7443aa20294ddfc750e9eb11acd4218d9f3d94157af9cb69fe9ed362cd994
CLIENT_TRAFFIC_SECRET_0 9bd9c146254f587546805a6cb223c00a58d5e78574f9edbff98ebe9dad838d39 1e041c85370549b439749d857eb9008d86aeaf5320fd556392a43fba40367d09
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>wireshark 配置解析 DEBUG 日志</p></li></ul><p><img src="`+d+`" alt="wireshark_tls_secret"></p><h3 id="验证" tabindex="-1"><a class="header-anchor" href="#验证" aria-hidden="true">#</a> 验证</h3><hr><ul><li>使用 chrome 访问测试接口，wireshark 可以解析到数据</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>https://l10n-pro.huobiasia.vip/-/x/pro/v1/common/timestamp
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="`+l+'" alt="wireshark_tls_test"></p>',11),n=[t];function c(o,u){return a(),s("div",null,n)}const m=e(r,[["render",c],["__file","wireshark_tls.html.vue"]]);export{m as default};
